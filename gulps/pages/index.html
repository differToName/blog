<!DOCTYPE html><html class="theme-next muse use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet"><link href="/css/main.css?v=5.1.4" rel="stylesheet"><link rel="icon" type="image/png" sizes="32x32" href="/images/smile.png?v=5.1.4"><meta name="keywords" content="Hexo, NexT"><link rel="alternate" href="/atom.xml" title="WanLong's blog" type="application/atom+xml"><meta name="description" content="WanLong的个人站，主要记录自己学习过程"><meta property="og:type" content="website"><meta property="og:title" content="WanLong&#39;s blog"><meta property="og:url" content="http://bigyyl.cn/index.html"><meta property="og:site_name" content="WanLong&#39;s blog"><meta property="og:description" content="WanLong的个人站，主要记录自己学习过程"><meta property="og:locale" content="zh-Hans"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="WanLong&#39;s blog"><meta name="twitter:description" content="WanLong的个人站，主要记录自己学习过程"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Muse",version:"5.1.4",sidebar:{position:"left",display:"always",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://bigyyl.cn/"><title>WanLong's blog</title></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-home"><div class="headband"></div><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">WanLong's blog</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">耐心、专注、沉着</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="menu-item-icon fa fa-fw fa-calendar"></i><br>日程表</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://bigyyl.cn/2019/01/17/Docker之理论基础/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="WanLong"><meta itemprop="description" content=""><meta itemprop="image" content="http://132.232.77.229/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="WanLong's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2019/01/17/Docker之理论基础/" itemprop="url">Docker之理论基础</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-17T19:37:00+08:00">2019-01-17 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://bigyyl.cn/2019/01/16/java/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="WanLong"><meta itemprop="description" content=""><meta itemprop="image" content="http://132.232.77.229/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="WanLong's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2019/01/16/java/" itemprop="url">java之线程</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-16T18:05:00+08:00">2019-01-16 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/java基础/" itemprop="url" rel="index"><span itemprop="name">java基础</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://bigyyl.cn/2018/03/17/Redis/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="WanLong"><meta itemprop="description" content=""><meta itemprop="image" content="http://132.232.77.229/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="WanLong's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2018/03/17/Redis/" itemprop="url">Redis</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-17T21:51:00+08:00">2018-03-17 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Redis/" itemprop="url" rel="index"><span itemprop="name">Redis</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="1-文件读写权限设置"><a href="#1-文件读写权限设置" class="headerlink" title="1.文件读写权限设置"></a>1.文件读写权限设置</h2><p><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E8%AE%BE%E7%BD%AE1.png" alt=""><br>chmod 777 XX文件，赋予该文件夹所有可读写等（不限制任何用户）<br>chmod -R 777 /文件夹名 可改变文件夹中所有文件和文件夹及子文件夹属性为可读可写可执行<br>其中777分别是代表 user、group、other的权限每个7转换成二进制111分别代表rwx（读写执行），在linux中为-则代表权限未授予。</p><p>在终端输入：<br>chmod o w xxx.xxx<br>表示给其他人授予写xxx.xxx这个文件的权限<br>chmod go-rw xxx.xxx<br>表示删除xxx.xxx中组群和其他人的读和写的权限<br>其中：<br>u 代表所有者（user）<br>g 代表所有者所在的组群（group）<br>o 代表其他人，但不是u和g （other）<br>a 代表全部的人，也就是包括u，g和o<br>r 表示文件可以被读（read）<br>w 表示文件可以被写（write）<br>x 表示文件可以被执行（如果它是程序的话）<br>其中：rwx也可以用数字来代替<br>r ————4<br>w ————2<br>x ————1<br>- ————0</p><p>行动：<br>表示添加权限<br>- 表示删除权限<br>= 表示使之成为唯一的权限</p><p>常见的以下的一些权限修改：<br>-rw——- (600) 只有所有者才有读和写的权限<br>-rw-r–r– (644) 只有所有者才有读和写的权限，组群和其他人只有读的权限<br>-rwx—— (700) 只有所有者才有读，写，执行的权限<br>-rwxr-xr-x (755) 只有所有者才有读，写，执行的权限，组群和其他人只有读和执行的权限<br>-rwx–x–x (711) 只有所有者才有读，写，执行的权限，组群和其他人只有执行的权限<br>-rw-rw-rw- (666) 每个人都有读写的权限<br>-rwxrwxrwx (777) 每个人都有读写和执行的权限</p><h2 id="2-redis数据结构"><a href="#2-redis数据结构" class="headerlink" title="2.redis数据结构"></a>2.redis数据结构</h2><p>热点高频数据<br>redis是一种告警的key:value存储系统，value支持五种类型：</p><ol><li>字符串 strings</li><li>字符串列表 lists</li><li>字符串集合 sets</li><li>有序字符串集合 sorted sets</li><li>哈希 hashes</li></ol><p>关于key的注意事项：</p><ol><li>key不要太长，尽量不要超过1024字节，这不仅消耗内存，而且会降低查找的效率；</li><li>key也不要太短，太短的话，key的可读性会降低；</li><li>在一个项目中，key最好使用统一的命名模式，例如user:10000:passwd。</li></ol><p>3.redis相关指令操作</p><ul><li><p>strings<br>简单例子：<br>set mystr “hello world” 设置一个值为hello world的字符串mystr<br>get mystr 获取key为mystr的字符串<br>对字符串进行数值操作（INCR、INCRBY、DECR、DECRBY等）：<br>set mynums “2”<br>incr mynums<br>get mynums 输出”3”</p></li><li><p>lists<br>redis中的lists在底层实现上并不是数组，而是链表，也就是说对于大量数据lists来说，增删复杂度都是常数级别<br>lists的操作一般有LPUSH（左插入）、RPUSH（右插入）、LRANGE（取出某范围）等<br>简单案例：<br>lpush mylist “1” 创建一个名叫mylist的list，并在列表头部插入元素“1”<br>lrange mylist 0 1 列出mylist中从编号0到1的元素<br>lrange mylist 0 -1 列出mylist中从编号0到倒数第一个元素<br><strong>注意</strong>：lists是有先后顺序的，可以应用于消息队列，而且可以保证先后顺序，同时可以通过LRANGE还可以实现分页功能。</p></li><li>集合（无序）<br>在redis中，集合是一种无序的集合，集合中的元素没有先后顺序。<br>sadd myset “one” 相机和myset中加入一个新元素”one”<br>smembers myset 列出集合myset中的所有元素<br>sismember myset “one” 判断元素1是否在集合myset中，返回1表示存在，返回0表示不存在<br>sunion myset yourset 对两个集合求并集</li><li>有序集合<br>有序集合中的每个元素都关联一个序号（score），这是排序的依据。<br>在redis中有序集合叫做zsets，其先关指令都是z开头的。<br>zadd myset 1 baidu.com 向myset中新增一个元素baidu.com，它的序号是1<br>zrange myset 0 -1 with scores 列出myset的所有元素，同时列出其序号，有序输出<br>zrange myset 0 -1 值列出myset的元素，不包含序号</li><li>哈希<br>哈希是redis 2.0.0之后才有的数据结构。<br>哈希存的是字符串和字符串值之间的映射，如用户要存储其全名、姓氏、年龄等，适合用哈希<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HMSET user:001 username antirez password p1p1p age 25	    建立哈希，并赋值，user：001用户名是antirez，密码是p1p1p，年龄是25.  </span><br><span class="line">HGETALL user:001				列出哈希的内容</span><br></pre></td></tr></table></figure></li></ul><h2 id="3-redis持久化的两种方式"><a href="#3-redis持久化的两种方式" class="headerlink" title="3.redis持久化的两种方式"></a>3.redis持久化的两种方式</h2><p>redis提供了两种持久化的方式，分别是RDB（Redis DataBase）和AOF（Append Only File）。</p><p>RDB，简而言之，就是在不同的时间点，将redis存储的数据生成快照并存储到磁盘等介质上；</p><p>AOF，则是换了一个角度来实现持久化，那就是将redis执行过的所有写指令记录下来，在下次redis重新启动时，只要把这些写指令从前到后再重复执行一遍，就可以实现数据恢复了。</p><p>其实RDB和AOF两种方式也可以同时使用，在这种情况下，如果redis重启的话，则会优先采用AOF方式来进行数据恢复，这是因为AOF方式的数据恢复完整度更高。</p><p>如果你没有数据持久化的需求，也完全可以关闭RDB和AOF方式，这样的话，redis将变成一个纯内存数据库，就像memcache一样。</p><h3 id="持久化方式RDB"><a href="#持久化方式RDB" class="headerlink" title="持久化方式RDB"></a>持久化方式RDB</h3><p>RDB方式，是将redis某一时刻的数据持久化到磁盘中，是一种快照式的持久化方法。<br>redis在进行数据持久化的过程中，会先将数据写入到一个临时文件中，待持久化过程都结束了，才会用这个临时文件替换上次持久化好的文件。正是这种特性，让我们可以随时来进行备份，因为快照文件总是完整可用的。</p><p>对于RDB方式，redis会单独创建（fork）一个子进程来进行持久化，而主进程是不会进行任何IO操作的，这样就确保了redis极高的性能。</p><p>如果需要进行大规模数据的恢复，且对于数据恢复的完整性不是非常敏感，那RDB方式要比AOF方式更加的高效。</p><p>虽然RDB有不少优点，但它的缺点也是不容忽视的。如果你对数据的完整性非常敏感，那么RDB方式就不太适合你，因为即使你每5分钟都持久化一次，当redis故障时，仍然会有近5分钟的数据丢失。所以，redis还提供了另一种持久化方式，那就是AOF。</p><h3 id="持久化方式AOF"><a href="#持久化方式AOF" class="headerlink" title="持久化方式AOF"></a>持久化方式AOF</h3><p>AOF，英文是Append Only File，即只允许追加不允许改写的文件。</p><p>如前面介绍的，AOF方式是将执行过的写指令记录下来，在数据恢复时按照从前到后的顺序再将指令都执行一遍，就这么简单。</p><p>我们通过配置redis.conf中的appendonly yes就可以打开AOF功能。如果有写操作（如SET等），redis就会被追加到AOF文件的末尾。</p><p>默认的AOF持久化策略是每秒钟fsync一次（fsync是指把缓存中的写指令记录到磁盘中），因为在这种情况下，redis仍然可以保持很好的处理性能，即使redis故障，也只会丢失最近1秒钟的数据。</p><p>如果在追加日志时，恰好遇到磁盘空间满、inode满或断电等情况导致日志写入不完整，也没有关系，redis提供了redis-check-aof工具，可以用来进行日志修复。</p><p>因为采用了追加方式，如果不做任何处理的话，AOF文件会变得越来越大，为此，redis提供了AOF文件重写（rewrite）机制，即当AOF文件的大小超过所设定的阈值时，redis就会启动AOF文件的内容压缩，只保留可以恢复数据的最小指令集。举个例子或许更形象，假如我们调用了100次INCR指令，在AOF文件中就要存储100条指令，但这明显是很低效的，完全可以把这100条指令合并成一条SET指令，这就是重写机制的原理。</p><p>在进行AOF重写时，仍然是采用先写临时文件，全部完成后再替换的流程，所以断电、磁盘满等问题都不会影响AOF文件的可用性，这点大家可以放心。</p><p>AOF方式的另一个好处，我们通过一个“场景再现”来说明。某同学在操作redis时，不小心执行了FLUSHALL，导致redis内存中的数据全部被清空了，这是很悲剧的事情。不过这也不是世界末日，只要redis配置了AOF持久化方式，且AOF文件还没有被重写（rewrite），我们就可以用最快的速度暂停redis并编辑AOF文件，将最后一行的FLUSHALL命令删除，然后重启redis，就可以恢复redis的所有数据到FLUSHALL之前的状态了。是不是很神奇，这就是AOF持久化方式的好处之一。但是如果AOF文件已经被重写了，那就无法通过这种方法来恢复数据了。</p><p>虽然优点多多，但AOF方式也同样存在缺陷，比如在同样数据规模的情况下，AOF文件要比RDB文件的体积大。而且，AOF方式的恢复速度也要慢于RDB方式。</p><p>如果你直接执行BGREWRITEAOF命令，那么redis会生成一个全新的AOF文件，其中便包括了可以恢复现有数据的最少的命令集。</p><p>如果运气比较差，AOF文件出现了被写坏的情况，也不必过分担忧，redis并不会贸然加载这个有问题的AOF文件，而是报错退出。这时可以通过以下步骤来修复出错的文件：</p><ol><li>备份被写坏的AOF文件</li><li>运行redis-check-aof –fix进行修复</li><li>用diff -u来看下两个文件的差异，确认问题点</li><li>重启redis，加载修复后的AOF文件</li></ol><h3 id="AOF重写原理"><a href="#AOF重写原理" class="headerlink" title="AOF重写原理"></a>AOF重写原理</h3><p>在重写即将开始之际，redis会创建（fork）一个“重写子进程”，这个子进程会首先读取现有的AOF文件，并将其包含的指令进行分析压缩并写入到一个临时文件中。</p><p>与此同时，主工作进程会将新接收到的写指令一边累积到内存缓冲区中，一边继续写入到原有的AOF文件中，这样做是保证原有的AOF文件的可用性，避免在重写过程中出现意外。</p><p>当“重写子进程”完成重写工作后，它会给父进程发一个信号，父进程收到信号后就会将内存中缓存的写指令追加到新AOF文件中。</p><p>当追加结束后，redis就会用新AOF文件来代替旧AOF文件，之后再有新的写指令，就都会追加到新的AOF文件中了。</p><h2 id="4-redis主从结构"><a href="#4-redis主从结构" class="headerlink" title="4.redis主从结构"></a>4.redis主从结构</h2><p>redis至此主从同步，并且支持一主多从结构。</p><p>主从结构的作用是避免冗余、提升性能，一些比较消耗性能的操作（如SORT）就可以放到从服务器分担。</p><p>主从架构中，可以关闭主服务器持久化功能，只让从服务器进行持久化功能，这样可提升主服务器性能。</p><p>主从架构中，从服务器通常只能是读模式，但是它们仍然能够接受CONFIG等指令，所以不应该将从服务器直接暴露在不安全网络环境中，如果必须如此，尽量对指令进行重命名。</p><h3 id="主从结构同步原理"><a href="#主从结构同步原理" class="headerlink" title="主从结构同步原理"></a>主从结构同步原理</h3><p>从服务器会向主服务器发出SYNC指令，当主服务器接到此命令后，就会调用BGSAVE指令来创建一个子进程专门进行数据持久化工作，也就是将主服务器的数据写入RDB文件中。在数据持久化期间，主服务器将执行的写指令都缓存在内存中。</p><p>在BGSAVE指令执行完成后，主服务器会将持久化好的RDB文件发送给从服务器，从服务器接到此文件后会将其存储到磁盘上，然后再将其读取到内存中。这个动作完成后，主服务器会将这段时间缓存的写指令再以redis协议的格式发送给从服务器。</p><p>另外，要说的一点是，即使有多个从服务器同时发来SYNC指令，主服务器也只会执行一次BGSAVE，然后把持久化好的RDB文件发给多个下游。在redis2.8版本之前，如果从服务器与主服务器因某些原因断开连接的话，都会进行一次主从之间的全量的数据同步；而在2.8版本之后，redis支持了效率更高的增量同步策略，这大大降低了连接断开的恢复成本。</p><p>主服务器会在内存中维护一个缓冲区，缓冲区中存储着将要发给从服务器的内容。从服务器在与主服务器出现网络瞬断之后，从服务器会尝试再次与主服务器连接，一旦连接成功，从服务器就会把“希望同步的主服务器ID”和“希望请求的数据的偏移位置（replication offset）”发送出去。主服务器接收到这样的同步请求后，首先会验证主服务器ID是否和自己的ID匹配，其次会检查“请求的偏移位置”是否存在于自己的缓冲区中，如果两者都满足的话，主服务器就会向从服务器发送增量内容。</p><p>增量同步功能，需要服务器端支持全新的PSYNC指令。这个指令，只有在redis-2.8之后才具有。</p><h3 id="5-redis事务处理"><a href="#5-redis事务处理" class="headerlink" title="5.redis事务处理"></a>5.redis事务处理</h3><p>事务是一个动作要么完成，要么什么都没做。<br>与redis事务相关的指令有MULTI、EXEC、DISCARD、WATCH。这四个指令是redis事务处理的基础</p><ul><li>MULTI用来组装一个事务</li><li>EXEC用来执行一个事务</li><li>DISCARD用来取消一个事务</li><li>WATCH用来监视一些key，一旦这些key在事务执行之前被改变，则取消事务的执行。</li></ul><p>如果redis开启了AOF持久化的话，那么一旦事务被成功执行，事务中的命令就会通过write命令一次性写到磁盘中去，如果在向磁盘中写的过程中恰好出现断电、硬件故障等问题，那么就可能出现只有部分命令进行了AOF持久化，这时AOF文件就会出现不完整的情况，这时，我们可以使用 redis-check-aof工具来修复这一问题，这个工具会将AOF文件中不完整的信息移除，确保AOF文件完整可用。</p><p>有关事务，一般会遇到两类错误：</p><ol><li>调用EXEC之前的错误</li><li>调用EXEC之后的错误</li></ol><p>“调用EXEC之前的错误”，有可能是由于语法有误导致的，也可能时由于内存不足导致的。只要出现某个命令无法成功写入缓冲队列的情况，redis都会进行记录，在客户端调用EXEC时，redis会拒绝执行这一事务。（这时2.6.5版本之后的策略。在2.6.5之前的版本中，redis会忽略那些入队失败的命令，只执行那些入队成功的命令）。</p><p>而对于“调用EXEC之后的错误”，redis则采取了完全不同的策略，即redis不会理睬这些错误，而是继续向下执行事务中的其他命令。这是因为，对于应用层面的错误，并不是redis自身需要考虑和处理的问题，所以一个事务中如果某一条命令执行失败，并不会影响接下来的其他命令的执行。</p><p>WATCH本身作用是监视key是否被改动过，而且支持同时监视多个key，它可以帮我们实现类似于“乐观锁”的效果，即CAS（check and set）。只要还没真正触发事务，WATCH都会尽职尽责的监视，一旦发现某个key被修改了，在执行EXEC时就会返回nil，表示事务无法触发。</p><h2 id="6-常用命令及解析"><a href="#6-常用命令及解析" class="headerlink" title="6.常用命令及解析"></a>6.常用命令及解析</h2><p>redis默认16个库，使用select + 数字切换（0开始）<br>keys *显示当前数据库所有的key<br>move key 数字，移动某个key到某个库</p><h3 id="key操作："><a href="#key操作：" class="headerlink" title="key操作："></a>key操作：</h3><p><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/key%E6%93%8D%E4%BD%9C.png" alt=""></p><p><strong>常用命令</strong>：<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.png" alt=""></p><h3 id="String操作："><a href="#String操作：" class="headerlink" title="String操作："></a>String操作：</h3><p><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/string%E6%93%8D%E4%BD%9C.png" alt=""><br>举例多个操作：<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/String%E6%93%8D%E4%BD%9C%E4%B8%BE%E4%BE%8B.png" alt=""></p><h3 id="List命令："><a href="#List命令：" class="headerlink" title="List命令："></a>List命令：</h3><p>常用（部分）：<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/List%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A8.png" alt=""><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/List%E5%91%BD%E4%BB%A4%E5%B8%B8%E7%94%A82.png" alt=""></p><h3 id="set命令："><a href="#set命令：" class="headerlink" title="set命令："></a>set命令：</h3><p>常用：<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/set%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.png" alt=""><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/set%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A42.png" alt=""></p><h3 id="Hash命令："><a href="#Hash命令：" class="headerlink" title="Hash命令："></a>Hash命令：</h3><p>常用：<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/Hash%E5%91%BD%E4%BB%A4.png" alt=""><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/Hash%E5%91%BD%E4%BB%A42.png" alt=""></p><h3 id="ZSet命令："><a href="#ZSet命令：" class="headerlink" title="ZSet命令："></a>ZSet命令：</h3><p><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/ZSet%E5%91%BD%E4%BB%A4.png" alt=""></p><h2 id="7-redis配置"><a href="#7-redis配置" class="headerlink" title="7.redis配置"></a>7.redis配置</h2><p>redis是单进程<br>redis配置文件被分为了几大区域，他们分别是：</p><ol><li>通用（general）</li><li>快照（snapshotting）</li><li>复制（replication）</li><li>安全（security）</li><li>限制（limits)</li><li>追加模式（append only mode)</li><li>LUA脚本（lua scripting)</li><li>慢日志（slow log)</li><li>事件通知（event notification）</li></ol><h3 id="redis-config文件配置解析"><a href="#redis-config文件配置解析" class="headerlink" title="redis.config文件配置解析"></a>redis.config文件配置解析</h3><p><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/redis.config%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%E8%A7%A3%E6%9E%90.png" alt=""></p><p><strong>Units单位</strong>：</p><ol><li>配置大小单位，开头定义了一些基本的度量单位，只支持bytes不支持bit</li><li>对大小写不敏感</li></ol><p><strong>Include包含</strong>：<br>&emsp;&emsp;和我们的Struts2配置文件类似，可以通过includes包含，redis.conf可以作为总阀,包含其它</p><p><strong>Genertal通用</strong>：<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/Gennertal%E9%80%9A%E7%94%A8.png" alt=""></p><ul><li><p>tcp-bacing<br>设置tcp的backlog，backlog其实是一个连续队列，backlog队列总和 = 未完成三次握手队列 + 已完成三次握手队列。在高并发环境下，你需要一个高backlog值来避免慢客户端连接问题，注意Linux内核会将这个值减小到/proc/sys/net/core/somaxconn的值，所以需要确认增大somaxconn和tcp_max_syn_bcaklog两个值来达到想要的效果</p></li><li><p>Tcp-keepalive<br>单位为秒，如果设置为0，则不会进行Keepalive检测，建议设置成60</p></li><li><p>Syslog-enabled<br>是否把日志输出到syslog中</p></li><li><p>Syslog-ident<br>指定syslog里的日志标志</p></li><li><p>Syslog-facility<br>指定syslog设备，值可以是USER或LOACL0-LOCAL7</p></li></ul><p>快照：</p><p>安全：</p><p>limit限制：</p><ul><li>Maxclients</li><li>Maxmemory</li><li>Maxmemory-policy</li><li>Maxmemory-samples</li></ul><p>Maxmemory-policy</p><ol><li>volatile-lru :使用LRU算法移除key，只对设置了过期时间的键</li><li>allkeys-lru：使用LRU算法移除key</li><li>volatile-random：在过期集合中移除随机的key，只对设置了过期时间的键</li><li>allkeys-random：移除随机的key</li><li>volatile-ttl: 移除那些TTL值最小的key，即那些最近要过期的key</li><li>noeviction：不尽兴移除，针对写操作，只是返回错误信息</li></ol><p>Maxmemory-samples<br>设置样本数量，LRU算法和最小TTL算法都并非是精准的算法，而是估算值，所以你可以设置样本大小，redis默认会检查这么多个key并选择其中LRU的那个</p><h3 id="常见Redis-config文件介绍："><a href="#常见Redis-config文件介绍：" class="headerlink" title="常见Redis.config文件介绍："></a>常见Redis.config文件介绍：</h3><p><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/%E5%B8%B8%E8%A7%81redis.config%E4%BB%8B%E7%BB%8D1.png" alt=""><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/%E5%B8%B8%E8%A7%81redis.config%E4%BB%8B%E7%BB%8D2.png" alt=""><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/%E5%B8%B8%E8%A7%81redis.config%E4%BB%8B%E7%BB%8D3.png" alt=""><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/%E5%B8%B8%E8%A7%81redis.config%E4%BB%8B%E7%BB%8D4.png" alt=""><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/%E5%B8%B8%E8%A7%81redis.config%E4%BB%8B%E7%BB%8D5.png" alt=""><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/%E5%B8%B8%E8%A7%81redis.config%E4%BB%8B%E7%BB%8D6.png" alt=""></p><h2 id="8-redis的发布与订阅"><a href="#8-redis的发布与订阅" class="headerlink" title="8.redis的发布与订阅"></a>8.redis的发布与订阅</h2><p>进程间的一种消息通信模式：发送者(pub)发送消息，订阅者(sub)接受消息。<br>订阅/发布消息图：<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/redis%E5%8F%91%E5%B8%83%E4%B8%8E%E8%AE%A2%E9%98%851.png" alt=""><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/redis%E5%8F%91%E5%B8%83%E4%B8%8E%E8%AE%A2%E9%98%851.png" alt=""><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/redis%E5%8F%91%E5%B8%83%E4%B8%8E%E8%AE%A2%E9%98%85%E5%91%BD%E4%BB%A4.png" alt=""></p><p><strong>案例</strong><br>先订阅后发布才能收到消息：</p><ol><li>可以一次性订阅多个，SUBSCRIBE c1 c2 c3</li><li>消息发布，PUBLISH c2 hello-redis</li><li>订阅多个，通配符<em>，PSUBSCRIBE new</em></li><li>收取消息，PUBLISH new1 redis2015</li></ol><h2 id="9-redis的主从复制：（master-slave）"><a href="#9-redis的主从复制：（master-slave）" class="headerlink" title="9.redis的主从复制：（master/slave）"></a>9.redis的主从复制：（master/slave）</h2><p>主从复制读写分离<br>也就是我们所说的主从复制，主机数据更新后根据配置和策略，自动同步到备机的master/slaver机制，Master以写为主，Slave以读为主。</p><p>用法:<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/redis%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6.png" alt=""><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/redis%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B62.png" alt=""></p><p>PID文件名字是保存pid的文件，Dump.rdb是备份文件</p><p><strong>一主二仆</strong>：<br>以自定义文件启动：redis-server /配置文件路径<br>以某个端口启动： redis-cli -p 端口</p><p>如下命令，查看当前客户端信息，master是主机<br><code>127.0.0.1:6379&gt;info replication</code><br>SLAVEOF 地址 主机端口号 设置成从服务，将同步全部主机数据<br>从机只能读不能写，主机能写</p><p>主机Shutdown，从机还是slave状态，status为down状态，原机待命。<br>从机Shutdown，都需要重新连接，除非写在配置文件中。</p><p><strong>薪火相传</strong>：<br>上种模式中心化严重，本次要去中心化，以一个一个（一对一）方式传递下去（缺点延时）<br>中途变更转向：会清除之前的数据，重新建立拷贝最新的Salveof新主库IP，新主库端口（保证数据实时）</p><p>中间传递服务还是slave，他有另一个slave连接</p><p><strong>反客为主</strong>：<br>主机挂掉，从机顶替。<br>Slaveof no one 从主机变主机。<br>主机从连后，仍然是master，但是以前的从机不会再连接。</p><p><strong>Redis复制原理</strong>：<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/redis%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86.png" alt=""><br><strong>哨兵模式</strong>：<br>反客为主自动版。能够在后台监控主机是否故障，如果故障了根据投票选举从库为主库。<br>设置方法：<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F.png" alt=""><br>touch sentinel.conf(文件名不能错)<br>主库挂掉后，选出新的主库后，旧主库再连接将变成从库<br>一组sentinel能同时监控多个Master</p><p>缺点：<br>由于所有的写操作都是现在Master上操作，然后同步更新到Slave上，所以从Master同步到Slave机器有一定的延迟，当系统报警忙时，延迟问题会更加严重，Slave机器数量的增加也会使这个问题更加严重。</p><h2 id="10-事务"><a href="#10-事务" class="headerlink" title="10.事务"></a>10.事务</h2><p>日常操作：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">public class TestTX&#123;</span><br><span class="line">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class="line">        if(transMethod())&#123;</span><br><span class="line">            System.out.println(&quot;成功交易&quot;);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            System.out.println(&quot;交易失败&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static boolean transMethod() throws InterruptedException &#123;</span><br><span class="line">        Jedis jedis  = new Jedis(&quot;192.168.4.28&quot;,6379);</span><br><span class="line"></span><br><span class="line">        jedis.set(&quot;balance&quot;,&quot;100&quot;);</span><br><span class="line">        jedis.set(&quot;debt&quot;,&quot;0&quot;);</span><br><span class="line"></span><br><span class="line">        int balance;</span><br><span class="line">        int debt;</span><br><span class="line">        int consume = 20;</span><br><span class="line">        jedis.watch(&quot;balance&quot;);</span><br><span class="line">        Thread.sleep(7000);</span><br><span class="line">        balance = Integer.parseInt(jedis.get(&quot;balance&quot;));</span><br><span class="line">        if(balance &lt; consume)&#123;</span><br><span class="line">            jedis.unwatch();</span><br><span class="line">            System.out.println(&quot;已经被修改&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            System.out.println(&quot;开始业务：&quot;);</span><br><span class="line">            Transaction transaction =jedis.multi();</span><br><span class="line">            transaction.decrBy(&quot;balance&quot;,consume);</span><br><span class="line">            transaction.incrBy(&quot;debt&quot;,consume);</span><br><span class="line">            transaction.exec();</span><br><span class="line">            System.out.println(jedis.get(&quot;balance&quot;));</span><br><span class="line">            System.out.println(jedis.get(&quot;debt&quot;));</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>transaction.discard();//撤回事务</p><p>锁：<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/redis%E9%94%81.png" alt=""><br>举例：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public boolean transMethod()&#123;</span><br><span class="line">    Jedis jedis = new Jedis(&quot;127.0.0.1&quot;,6379);</span><br><span class="line">    int balance;//可用余额</span><br><span class="line">    int debt;//欠额</span><br><span class="line">    int amtToSubtract = 10;//实际额度</span><br><span class="line">    jedis.watch(&quot;balance&quot;);</span><br><span class="line">    balance = Integer.parseInt(jedis.get(&quot;balance&quot;));</span><br><span class="line">    if(balance &lt; amtToSubtract)&#123;</span><br><span class="line">        jedis.unwatch();</span><br><span class="line">        return false;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        //事务</span><br><span class="line">        Transaction transaction = jedis.multi();</span><br><span class="line">        transaction.decrBy(&quot;balance&quot;,amtToSubtract);</span><br><span class="line">        transaction.incrBy(&quot;debt&quot;,amtToSubtract);</span><br><span class="line">        transaction.exec();</span><br><span class="line">        balance = Integer.parseInt(jedis.get(&quot;balance&quot;));</span><br><span class="line">        debt = Integer.parseInt(jedis.get(&quot;debt&quot;));</span><br><span class="line"></span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>11.JedisPool的配置参数：<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/redis/JedisPool%E7%9A%84%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0.png" alt=""></p><p>参考文章：<a href="https://blog.csdn.net/liqingtx/article/details/60330555" target="_blank" rel="noopener">https://blog.csdn.net/liqingtx/article/details/60330555</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://bigyyl.cn/2018/02/28/SpringCloud五之Eureka服务注册与发现/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="WanLong"><meta itemprop="description" content=""><meta itemprop="image" content="http://132.232.77.229/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="WanLong's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2018/02/28/SpringCloud五之Eureka服务注册与发现/" itemprop="url">SpringCloud五之Eureka服务注册与发现</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-28T16:42:00+08:00">2018-02-28 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/SpringCloud/" itemprop="url" rel="index"><span itemprop="name">SpringCloud</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="1-什么是Eureka？"><a href="#1-什么是Eureka？" class="headerlink" title="1.什么是Eureka？"></a>1.什么是Eureka？</h2><p>&emsp;&emsp;Eureka是Netflix的一个子模块，也是核心模块之一。Eureka是一个基于REST的服务，用于定位服务，以实现云端中间层服务发现和故障转移。服务注册与发现（Eureka管理）对于微服务架构来说非常重要，有了服务发现与注册，只需要使用服务的标识符，就可以访问到服务，而不需要修改服务调用（Consumer）的配置文件。功能类似于dubbo的注册中心，比如zookeeper。<br>&emsp;&emsp;Netflix在设计Eureka时遵守的就是AP原则。<br>&emsp;&emsp;Eureka相当于各种微服务在其注册的花名册</p><h3 id="CAP"><a href="#CAP" class="headerlink" title="CAP"></a>CAP</h3><p>&emsp;&emsp;Zookeeper遵守 （总的）CAP的设计原则，是Nosql数据库遵守的原则，及C:Consistency（强调一致性），A:Availability(可用性)，P:Patition tolerance(分区容错性)<br>&emsp;&emsp;CAP三进二，但是现在的分布式系统一般都是多个电脑，所以CAP中P是必须占有的<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">最多只能同时较好的满足两个</span><br><span class="line">    CAP理论的核心是：一个分布式系统不可能同时很好的满足一致性、可用性和分区容错性这三个需求，因此，根据CAP原理将NoSQL数据库分成了满足CA原则、满足CP原则和满足AP原则三大类：  </span><br><span class="line">    CA - 单点集群，满足一致性，可用性的系统，通常在可扩展性上不太强大。</span><br><span class="line">    CP - 满足一致性，分区容忍性的系统，通常性能不是特别高。</span><br><span class="line">    AP - 满足可用性，分区容忍性的系统，通常可能对一致性要求低一些</span><br></pre></td></tr></table></figure><p></p><div class="post-button text-center"><a class="btn" href="/2018/02/28/SpringCloud五之Eureka服务注册与发现/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://bigyyl.cn/2018/02/27/4-SpringCloud之Rest微服务构建案例/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="WanLong"><meta itemprop="description" content=""><meta itemprop="image" content="http://132.232.77.229/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="WanLong's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"><a class="post-title-link" href="/2018/02/27/4-SpringCloud之Rest微服务构建案例/" itemprop="url">SpringCloud四之Rest微服务构建案例</a></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-27T16:14:00+08:00">2018-02-27 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/SpringCloud/" itemprop="url" rel="index"><span itemprop="name">SpringCloud</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="1-构建分布式工程父工程模块"><a href="#1-构建分布式工程父工程模块" class="headerlink" title="1.构建分布式工程父工程模块"></a>1.构建分布式工程父工程模块</h2><p>&emsp;&emsp;父工程建立，maven project，主要是定义POM文件，将后续各个子模块公用的jar包等统一提出来，类似一个抽象父类<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/20190227/4Rest%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B1.png" alt="创建工程"><br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/20190227/4Rest%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B2.png" alt="GAV"></p><p>&emsp;&emsp;如果要引用某个工程，只要写下引用工程的GAV即可<br><img src="https://bigyyl-1256623201.cos.ap-chongqing.myqcloud.com/blog/20190227/4Rest%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B3.png" alt="参数"><br>&emsp;&emsp;主要是如下（注意在DependencyManagement中作为依赖管理），其它包见工程microservicecloud，如今cloud版本又升级，实际开发根据情况而定。</p><div class="post-button text-center"><a class="btn" href="/2018/02/27/4-SpringCloud之Rest微服务构建案例/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article></section><nav class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><section class="site-overview-wrap sidebar-panel sidebar-panel-active"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="http://132.232.77.229/images/avatar.gif" alt="WanLong"><p class="site-author-name" itemprop="name">WanLong</p><p class="site-description motion-element" itemprop="description">WanLong的个人站，主要记录自己学习过程</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">4</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">4</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/differToName" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://juejin.im" target="_blank" title="掘金"><i class="fa fa-fw fa-spinner"></i>掘金</a></span></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2019</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">WanLong</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-users"></i> <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="site-pv"><i class="fa fa-eye"></i> <span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/js/src/utils.js?v=5.1.4"></script><script src="/js/src/motion.js?v=5.1.4"></script><script src="/js/src/bootstrap.js?v=5.1.4"></script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={iconStyle:"box",boxForm:"horizontal",position:"bottomCenter",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-postbottom",pbOptions)</script></body></html>